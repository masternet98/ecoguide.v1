# 🚀 AI 추론 결과 저장 기능 - 빠른 시작 가이드

> AI 분석 결과가 자동으로 저장되고 대시보드에 표시됩니다!

---

## ⚡ 5분 안에 시작하기

### 1️⃣ 앱 실행 (1분)
```bash
streamlit run app_new.py
```
브라우저에서 `http://localhost:8501` 열림

### 2️⃣ 이미지 분석 (2분)
1. **이미지 업로드** → 원하는 물품 사진 선택
2. **AI 분석** → "분석 시작" 버튼 클릭
3. **결과 확인** → AI가 물품을 분석합니다

### 3️⃣ 라벨 저장 (1분)
1. **확인 섹션** → 분류와 크기 정보 검토
2. **필요시 수정** → 물품명이나 분류 수정 가능
3. **저장** → "학습 데이터로 저장" 클릭 ✅

### 4️⃣ 대시보드에서 확인 (1분)
1. 좌측 사이드바 → **관리자 전용** 섹션
2. **라벨링 데이터 대시보드** 클릭
3. **"라벨링 데이터" 탭** → 저장된 라벨 목록
4. 각 라벨 카드에서 **"🤖 AI 추론"** 섹션 확인

---

## 📊 대시보드에서 보는 AI 추론 정보

### 데이터 브라우저 탭 (간단한 요약)
```
┌─────────────────────────────────────┐
│ 소파                                │
│ FURN > FURN_SOFA                   │
│ 📏 크기: W:180cm / H:85cm / D:95cm  │
│ 🤖 AI 추론:                        │
│    물품: 소파                        │
│    신뢰도: 85%                      │
│    추론: 이 물품은 소파로 보입니다...  │
│                                    │
│ [상세 보기] [삭제]                  │
└─────────────────────────────────────┘
```

### 상세 보기 (완전한 정보)
```
📊 분석 결과
────────────────────────────────────────
저장 시간: 2025-10-27 14:23:45
판단 근거: 이 물품은 소파로 보입니다...

라벨링 품질: 75%
AI 추론 품질: 92%  ← AI가 얼마나 자신감 있게 분석했는지

────────────────────────────────────────
🤖 AI 추론 결과
────────────────────────────────────────
감지된 물품: 소파
주 카테고리: FURN (가구)
세부 카테고리: FURN_SOFA (소파)
AI 신뢰도: 85%

추론 근거:
이 물품은 소파로 보입니다. 가구 카테고리의
소파로 분류됩니다.

추론 크기:
가로: 180cm | 높이: 85cm | 깊이: 95cm
```

---

## 🎯 주요 기능

| 기능 | 설명 | 위치 |
|------|------|------|
| **자동 저장** | 라벨 저장 시 AI 분석 결과 자동 포함 | app_new.py |
| **품질 점수** | AI가 얼마나 자신감 있게 분석했는지 (0~100%) | 대시보드 |
| **크기 정보** | AI가 감지한 물품 크기 | 상세 보기 탭 |
| **추론 근거** | AI가 왜 이렇게 분석했는지 설명 | 상세 보기 탭 |
| **물품명 추적** | 사용자가 수정한 물품명 기록 | 라벨 메타데이터 |

---

## 💡 예시: 물품명 수정까지의 전체 흐름

### 시나리오: 소파를 "소파"라고 잘못 인식한 경우

**Step 1: 이미지 분석**
```
사용자: 소파 이미지 업로드
↓
AI: "물품명: 소파, 신뢰도: 85%, 크기: 180x85x95cm"
```

**Step 2: 확인 및 수정**
```
사용자가 본 것: AI는 "소파"라고 했지만, 실제로는 "2인용 가죽 소파"다!
↓
사용자: "수정이 필요합니다" 선택
↓
입력: "2인용 가죽 소파" 입력
```

**Step 3: 저장**
```
사용자: "학습 데이터로 저장" 클릭
↓
시스템이 자동으로:
  - AI 분석 결과 저장
  - 사용자 수정 기록
  - 품질 점수 계산
```

**Step 4: 대시보드 확인**
```
관리자: 대시보드 → 상세 보기
↓
볼 수 있는 정보:
  ✓ AI는 "소파"라고 분석 (신뢰도 85%)
  ✓ 사용자가 "2인용 가죽 소파"로 수정
  ✓ AI 추론 품질: 92% (신뢰도 높음)
  ✓ AI가 감지한 크기: 180x85x95cm
  ✓ AI의 추론 근거
```

---

## 🔍 AI 추론 품질 점수 이해하기

### 점수 계산 기준
```
AI 추론 품질 = ?

요소별 기여도:
├─ 신뢰도 (confidence)    → 50점 (최대)
│  예: 85% 신뢰도 = 42.5점
├─ 크기 정보 (dimensions) → 30점 (최대)
│  예: W/H/D 모두 있으면 = 30점
└─ 추론 근거 (reasoning)  → 20점 (최대)
   예: 추론 텍스트 있으면 = 20점
```

### 예시
```
케이스 1: 크기 없음
  신뢰도(85%) → 42.5점
  추론 있음    → 20점
  ─────────────────
  총점: 62.5% (중간 수준)

케이스 2: 크기 있음
  신뢰도(85%) → 42.5점
  크기 정보    → 30점
  추론 있음    → 20점
  ─────────────────
  총점: 92.5% (높은 수준)
```

---

## 📝 저장되는 정보

### 어디에 저장되나?
```
uploads/labels/{file_id}.json
```

### 어떤 정보가 저장되나?
```json
{
  "ai_inference": {
    "object_name": "소파",           // AI가 감지한 물품
    "confidence": 0.85,              // AI 신뢰도
    "reasoning": "이 물품은...",    // AI의 추론 근거
    "dimensions": {                  // AI가 감지한 크기
      "w_cm": 180,
      "h_cm": 85,
      "d_cm": 95
    }
  },
  "metadata": {
    "ai_inference_quality": 0.92     // 품질 점수
  }
}
```

---

## 🚀 테스트하기

### 자동 테스트 실행
```bash
python test_ai_inference_flow.py
```

**테스트 항목:**
- ✅ AI 추론 결과 저장
- ✅ 크기 정보 저장
- ✅ 품질 점수 계산
- ✅ 대시보드 표시 형식
- ✅ 물품명 수정 추적

**예상 결과:**
```
✅ 모든 테스트가 성공적으로 완료되었습니다!
  ✓ AI 추론 결과 저장 기능 동작
  ✓ AI 추론 데이터 포함 확인
  ✓ AI 추론 품질 점수 계산
  ✓ 대시보드 데이터 형식 확인
  ✓ ConfirmationService 통합
```

---

## ❓ 자주 묻는 질문

### Q1: AI 추론 결과가 대시보드에 안 보여요
**A:**
1. 라벨을 저장했는지 확인하세요 ("학습 데이터로 저장" 클릭됨)
2. 대시보드를 새로고침하세요 (F5)
3. "라벨링 데이터" 탭에서 확인하세요

### Q2: AI 추론 품질 점수가 낮은 이유는?
**A:**
- 신뢰도가 낮음 (예: 50% 미만)
- 크기 정보가 없음
- 추론 근거가 없음

→ 더 명확한 이미지를 업로드해보세요

### Q3: 물품명을 수정했는데 반영이 안 됐어요
**A:**
1. "수정이 필요합니다" 라디오 버튼 선택 확인
2. 텍스트 입력 필드에 올바른 이름 입력
3. "학습 데이터로 저장" 클릭
4. 대시보드에서 확인

### Q4: 대시보드에서 "원본 JSON 보기"는?
**A:**
- 상세 보기 탭의 맨 아래
- 저장된 전체 데이터를 JSON으로 확인 가능
- 개발자가 상세 정보를 확인할 때 유용

---

## 📚 더 자세히 알아보기

| 문서 | 내용 |
|------|------|
| `instructions/AI_INFERENCE_STORAGE_SUMMARY.md` | 상세 구현 가이드 |
| `VERIFICATION_REPORT.md` | 테스트 및 검증 결과 |
| `test_ai_inference_flow.py` | 테스트 코드 예시 |

---

## 🎉 완료!

이제 AI 추론 결과가 자동으로 저장되고 대시보드에 표시됩니다!

**다음 단계:**
1. ✅ `streamlit run app_new.py` 실행
2. ✅ 이미지 업로드 및 분석
3. ✅ 라벨 저장
4. ✅ 대시보드에서 AI 추론 결과 확인

**더 궁금한 점이 있으신가요?**
- 상세 가이드: `instructions/AI_INFERENCE_STORAGE_SUMMARY.md` 참조
- 테스트 코드: `test_ai_inference_flow.py` 실행

---

**Happy analyzing! 🚀**

