# AI 리팩토링 실행 요청서 📋

## 🎯 프로젝트 개요
**프로젝트명**: EcoGuide v1 리팩토링
**기간**: 4주 (2025-09-21 ~ 2025-10-19)
**목표**: 1인 개발자를 위한 안전하고 실용적인 코드 리팩토링
**최우선 원칙**: **프로그램 동작 오류 절대 금지**

## 📚 필수 참고 문서
실행 전 반드시 다음 문서들을 읽고 숙지해야 합니다:

1. **`practical-refactoring-plan.md`**: 전체 4주 리팩토링 계획
2. **`refactoring-checklist.md`**: 안전한 리팩토링 체크리스트
3. **`week1-detailed-plan.md`**: 1주차 7일 상세 실행 계획
4. **`safety-backup-guide.md`**: 백업/복구 시스템 가이드
5. **`CLAUDE.md`**: 프로젝트 구조 및 개발 가이드라인

## 🚨 핵심 안전 규칙 (절대 준수)

### ❌ 절대 금지사항
- 여러 파일을 동시에 수정
- 백업 없이 파일 변경
- 테스트 없이 변경사항 커밋
- 에러 상태로 작업 종료
- 기존 public 인터페이스 변경
- 복잡한 아키텍처 패턴 도입

### ✅ 필수 준수사항
- 매 변경 전 Git 커밋 백업
- 변경 후 즉시 앱 실행 테스트
- 문제 발생 시 즉시 백업 복원
- 하루 종료 전 전체 기능 확인
- 단계별 체크리스트 완료 확인

## 📋 실행 요청 사항

### 1단계: 환경 준비 및 현상 파악
```
요청: 다음 작업을 순서대로 실행해주세요.

1. 현재 프로젝트 상태 확인
   - `streamlit run app.py` 정상 실행 확인
   - 주요 페이지 3-4개 정상 동작 확인
   - Git 상태 확인: `git status`

2. 백업 시스템 구축
   - 프로젝트 전체 Git 커밋: "리팩토링 시작 전 전체 백업"
   - 주요 파일 개별 백업: district_service.py, monitoring_ui.py 등

3. 현황 분석 보고
   - 각 파일별 라인 수 현황
   - 발견된 문제점 목록
   - 1주차 실행 준비 상태 확인
```

### 2단계: 1주차 리팩토링 실행
```
요청: week1-detailed-plan.md에 따라 다음을 실행해주세요.

Day 1: district_service.py 분석 및 분해 계획
- 파일 구조 완전 분석
- 4개 파일 분해 계획 수립
- 리스크 분석 및 대응 방안

Day 2-5: 단계별 파일 분해
- district_loader.py 생성 (데이터 로딩)
- district_cache.py 생성 (캐시 관리)
- district_validator.py 생성 (데이터 검증)
- district_api.py 생성 (통합 인터페이스)

Day 6-7: monitoring_ui.py 분해
- 3개 파일로 안전하게 분해
- 전체 통합 테스트

⚠️ 각 단계마다 refactoring-checklist.md의 체크리스트 준수 필수
```

### 3단계: 진행상황 보고 및 검증
```
요청: 각 단계 완료 후 다음을 보고해주세요.

1. 완료된 작업 상세 내역
2. 생성/수정된 파일 목록
3. 체크리스트 완료 상황
4. 발견된 문제점 및 해결 방법
5. 다음 단계 준비 상태

⚠️ 문제 발생 시 safety-backup-guide.md에 따라 즉시 복구 실행
```

---

## 📊 체크리스트 진행률 추적표

### 🗓️ 1주차 진행률 (Week 1: 2025-09-21 ~ 2025-09-27)

#### Day 1: 분석 및 계획 (2025-09-21)
- [ ] **환경 준비**
  - [ ] 현재 앱 정상 실행 확인
  - [ ] Git 백업 완료: `git add . && git commit -m "Day 1 시작 전 백업"`
  - [ ] 개별 파일 백업: `cp district_service.py district_service.py.backup`

- [ ] **파일 분석**
  - [ ] district_service.py 전체 구조 파악
  - [ ] 클래스 및 메서드 목록 작성
  - [ ] 외부 의존성 관계 분석
  - [ ] Public 인터페이스 식별

- [ ] **분해 계획 수립**
  - [ ] 4개 파일 책임 범위 정의
  - [ ] 함수별 이동 계획 작성
  - [ ] Import 구조 설계
  - [ ] 리스크 분석 완료

#### Day 2: district_loader.py 생성 (2025-09-22)
- [ ] **작업 전 안전 조치**
  - [ ] Day 2 시작 전 Git 백업
  - [ ] 어제 작업 결과 정상 동작 확인

- [ ] **파일 생성 및 구현**
  - [ ] `src/services/district_loader.py` 생성
  - [ ] 데이터 로딩 함수들 이동 완료
  - [ ] Import 구문 정리 완료
  - [ ] 문법 오류 없음: `python -m py_compile district_loader.py`

- [ ] **테스트 및 검증**
  - [ ] 기본 동작 테스트 통과
  - [ ] 전체 앱 정상 실행 확인
  - [ ] 행정구역 데이터 로딩 기능 정상 동작
  - [ ] Git 커밋 완료: "district_loader.py 생성 완료"

#### Day 3: district_cache.py 생성 (2025-09-23)
- [ ] **작업 전 확인**
  - [ ] Day 3 시작 전 Git 백업
  - [ ] district_loader.py 정상 동작 확인

- [ ] **파일 생성 및 구현**
  - [ ] `src/services/district_cache.py` 생성
  - [ ] 캐시 관리 함수들 이동 완료
  - [ ] district_loader와 연동 확인
  - [ ] 문법 오류 없음 확인

- [ ] **테스트 및 검증**
  - [ ] 메모리 캐시 동작 테스트
  - [ ] 파일 캐시 동작 테스트
  - [ ] 전체 앱 정상 실행 확인
  - [ ] Git 커밋 완료

#### Day 4: district_validator.py 생성 (2025-09-24)
- [ ] **작업 전 확인**
  - [ ] Day 4 시작 전 Git 백업
  - [ ] 이전 2개 모듈 정상 동작 확인

- [ ] **파일 생성 및 구현**
  - [ ] `src/services/district_validator.py` 생성
  - [ ] 데이터 검증 함수들 이동 완료
  - [ ] 에러 처리 로직 이동 완료
  - [ ] 3개 모듈 간 연동 확인

- [ ] **테스트 및 검증**
  - [ ] 데이터 검증 기능 테스트
  - [ ] 에러 처리 로직 테스트
  - [ ] 전체 앱 정상 실행 확인
  - [ ] Git 커밋 완료

#### Day 5: district_api.py 통합 (2025-09-25)
- [ ] **작업 전 확인**
  - [ ] Day 5 시작 전 Git 백업
  - [ ] 3개 모듈 모두 정상 동작 확인

- [ ] **통합 API 생성**
  - [ ] `src/services/district_api.py` 생성
  - [ ] 기존 public 인터페이스 100% 유지
  - [ ] 4개 모듈 통합 완료
  - [ ] 하위 호환성 보장

- [ ] **전체 통합 테스트**
  - [ ] 전체 앱 정상 실행
  - [ ] 행정구역 관련 모든 기능 테스트
  - [ ] 모든 페이지 정상 동작 확인
  - [ ] Git 커밋 및 태그: `git tag district-service-refactored`

#### Day 6-7: monitoring_ui.py 분해 (2025-09-26~27)
- [ ] **분석 및 백업**
  - [ ] `monitoring_ui.py.backup` 생성
  - [ ] 파일 구조 분석 완료
  - [ ] 3개 파일 분해 계획 수립

- [ ] **파일 분해 실행**
  - [ ] `monitoring_dashboard.py` 생성 (UI 컴포넌트)
  - [ ] `monitoring_data.py` 생성 (데이터 처리)
  - [ ] `monitoring_charts.py` 생성 (차트 렌더링)

- [ ] **최종 검증**
  - [ ] 모니터링 페이지 완전 정상 동작
  - [ ] 전체 앱 모든 기능 정상 동작
  - [ ] 1주차 완료 보고서 작성
  - [ ] Git 태그: `git tag week1-complete`

---

## 📈 주차별 전체 진행률

### Week 1: 거대 파일 분해 ⏳
- **목표**: district_service.py (2,217줄) → 4개 파일, monitoring_ui.py (1,129줄) → 3개 파일
- **진행률**: ▢▢▢▢▢▢▢ (0/7일 완료)
- **상태**: 준비 완료 ✅

### Week 2: 중간 파일 정리 ⏸️
- **목표**: notification_service.py, prompt_service.py 등 800줄 이하로 분해
- **진행률**: ▢▢▢▢▢▢▢ (0/7일 완료)
- **상태**: 대기 중

### Week 3: 구조 최적화 ⏸️
- **목표**: core 폴더 단순화, 기본 테스트 추가
- **진행률**: ▢▢▢▢▢▢▢ (0/7일 완료)
- **상태**: 대기 중

### Week 4: 안정화 ⏸️
- **목표**: 문서화, 품질 관리, 최종 검증
- **진행률**: ▢▢▢▢▢▢▢ (0/7일 완료)
- **상태**: 대기 중

---

## 🎯 성공 기준 체크리스트

### 정량적 목표
- [ ] 모든 Python 파일 500줄 이하
- [ ] 앱 시작 시간 2분 이내 유지
- [ ] 모든 기존 기능 100% 정상 동작
- [ ] 새로운 에러나 경고 0개

### 정성적 목표
- [ ] 코드 가독성 향상 (파일당 기능 명확화)
- [ ] 새 기능 추가 시 수정 범위 예측 가능
- [ ] 버그 발생 시 원인 파악 시간 단축
- [ ] 1인 개발자가 3개월 후에도 코드 이해 가능

---

## 🚨 응급상황 대응

### 문제 발생 시 즉시 실행
1. **앱이 실행되지 않을 때**:
   ```bash
   git reset --hard HEAD~1
   streamlit run app.py
   ```

2. **특정 파일 문제 시**:
   ```bash
   cp src/services/파일명.py.backup src/services/파일명.py
   ```

3. **복구 후 보고**:
   - 문제 상황 상세 기록
   - 복구 방법 및 소요 시간
   - 재발 방지 대책

---

## 📞 요청 실행 방법

이 요청서를 AI에게 제공할 때:

1. **전체 맥락 제공**: "다음 리팩토링 요청서에 따라 작업을 실행해주세요"
2. **단계별 실행**: "1주차 Day 1부터 시작하여 체크리스트를 하나씩 완료해주세요"
3. **진행상황 확인**: "각 체크리스트 항목 완료 시 ✅ 체크하고 다음 단계로 진행해주세요"
4. **문제 발생 시**: "문제 발생 시 즉시 백업 복원 후 상황을 보고해주세요"

**⚠️ 중요**: 모든 안전 규칙을 준수하며, 프로그램 동작 오류가 절대 발생하지 않도록 주의해주세요.